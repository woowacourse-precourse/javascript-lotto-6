# 💁‍♀️ 프로젝트 설명

## 💰 로또 게임 설명

- 사용자는 금액을 지불하고 로또를 구입할 수 있다.
  - 로또 1장은 `1,000원`이다.
  - 지불한 금액만큼 로또를 구입할 수 있다. 단, 금액이 `1,000원`으로 나누어 떨어져야 한다.
- 로또 1장은 `1~45` 중 중복되지 않는 `6`개의 숫자를 갖는다. 번호는 랜덤하게 추출된다.
- 사용자는 `6`개의 당첨 번호와 `1`개의 보너스 번호를 입력할 수 있다.
- 사용자가 보유한 로또의 번호가 당첨 번호와 일치할 경우, 기준에 따라 보상을 받을 수 있다.

  ```
  당첨 기준 및 금액
  - 1등: 6개 번호 일치 ⇒ 2,000,000,000원
  - 2등: 5개 번호 + 보너스 번호 일치 ⇒ 30,000,000원
  - 3등: 5개 번호 일치 ⇒ 1,500,000원
  - 4등: 4개 번호 일치 ⇒ 50,000원
  - 5등: 3개 번호 일치 ⇒ 5,000원
  ```

- 사용자에게 로또 당첨 내역과 수익률을 안내한 뒤, 게임은 종료된다.

## 🔨 프로젝트 환경

- [애플리케이션 실행 환경 설정 가이드](CONFIG.md)

- [코드 컨벤션 환경 설정 가이드](CODE_CONVENTION.md)

## ⚡ 애플리케이션 실행 방법

[애플리케이션 실행 환경 설정](CONFIG.md)을 마친 뒤, 다음 명령어를 실행한다.

```shell
node ./src/index.js
```

## 🎨 MVC 패턴

`비즈니스 로직`과 `UI 로직`을 분리하기 위한 방법으로 MVC 패턴을 채택하였다.

### Model

```
- 로또 게임의 핵심 기능을 위한 데이터, 비즈니스 로직, 데이터 검증을 담당한다.
- 입출력, 게임 흐름 제어 등 역할에 어긋나는 작업을 하지 않는다.
- View와 의존성이 없어야 한다.
- Controller에 의한 애플리케이션의 흐름에 대해 알 수 없다.
```

- Lotto
  - 로또 번호를 배열로 받아 로또 한 장을 발행한다.
    - 로또 번호에 대해 검증한다.
    - 로또 번호를 오름차순으로 정렬한다.
- WinningLotto
  - 당첨 번호를 배열로 받아 당첨 로또 한 장을 발행한다.
    - `Lotto`를 상속한다.
  - 보너스 번호를 1개 갖는다.
    - 보너스 번호에 대해 검증한다.
- LottoMachine
  - 구입 금액을 받아 발행할 로또 장수를 계산한다.
    - 구입 금액에 대해 검증한다.
  - 발행할 장수만큼 로또 발행을 반복한다.
    - 1~45 중 중복되지 않는 숫자 6개를 랜덤으로 뽑아 로또를 생성한다.
- ResultCalculator
  - 발행한 로또와 당첨 로또의 번호를 비교해 당첨 여부를 확인한다.
  - 수익률을 계산한다.


### View

```
- 콘솔을 통한 사용자와의 상호작용, 입력 및 출력(에러 메시지 제외)을 담당한다.
- 입력 시 받은 데이터를 최소한으로 가공(예시: parsing)하여 반환한다. 데이터 검증은 수행하지 않는다.
- 출력 시 데이터를 출력 형식에 맞춰 출력한다. 데이터를 변형하지 않는다.
- Model과 의존성이 없어야 한다.
- Controller에 의한 애플리케이션의 흐름에 대해 알 수 없다.
```

- InputView
  - 구입 금액을 입력받아 반환한다.
    - 입력 값을 Number 타입으로 반환한다.
  - 당첨 번호를 입력받아 반환한다.
    - 입력 값을 parsing하여 Number 타입 배열로 반환한다.
  - 보너스 번호를 입력받아 반환한다.
    - 입력 값을 Number 타입으로 반환한다.
- OutputView
  - 구입한 로또 개수를 출력한다.
  - 구입한 로또 번호를 출력한다.
  - 로또 당첨 결과를 출력한다.
    - 로또 당첨 데이터와 당첨 기준 데이터를 받아, 출력 형식에 맞게 가공하여 출력한다.
  - 수익률을 출력한다.

### Controller

```
- Model과 View를 조작하여, 애플리케이션의 전체적인 흐름을 제어한다.
- Model과 View로부터 얻은 데이터를 사용하거나, 필요에 따라 각 모듈에 전달한다.
```

- GameController
  - 게임의 전체 흐름을 제어하는 메서드를 갖는다.
  - `InputView`을 통해 얻은 구입 금액을 `LottoMachine`에 전달하고, 로또 발행 메서드를 호출한다.
  - `LottoMachine`의 발행한 로또를 `OutputView`에 전달하고, 로또 번호 출력 메서드를 호출한다.
  - `InputView`을 통해 얻은 당첨 번호를 `WinningLotto`에 전달하고, 당첨 로또를 생성한다.
  - `InputView`을 통해 얻은 보너스 번호를 `WinningLotto`에 전달하고, 보너스 번호 할당 메서드를 호출한다.
  - `LottoMachine`의 발행한 로또 데이터와 `WinningLotto`의 당첨 로또 데이터를 `ResultCalculater`에 전달하고, 당첨 결과 및 수익률 계산 메서드를 호출한다.
  - `ResultCalculator`의 당첨 결과를 `OutputView`에 전달하고, 당첨 결과 출력 메서드를 호출한다.
  - `ResultCalculator`의 수익률을 `OutputView`에 전달하고, 수익률 출력 메서드를 호출한다.

## 테스트

`Jest`를 활용한다.

### 실행 방법

테스트를 실행하기 위해서는 [환경 설정](CONFIG.md)이 선행되어야 한다. 환경 설정을 다 하고 난 다음, 명령어를 통해 테스트를 실행할 수 있다.

```shell
npm test
```

### 테스트 코드

핵심 기능을 담당하고 있는 각 `Model`에 대한 유닛 테스트를 작성하였다. 유닛 테스트를 작성할 때, 모델이 담당하는 핵심 기능과 예외 사항을 중심으로 테스트하였다. 핵심 기능을 수행하는 데 필요한 세부 사항에 대해서는 테스트 코드를 작성하지 않았다.

UI로직을 담당하는 `View`에 대한 테스트 코드는 작성하지 않았으며, `Controller`에 대한 테스트는 `ApplicationTest.js`로 대체하였다.

---

# 📝 구현 기능 목록

## ✅ 입출력 기능

### 구입 금액 입력

- [x] 구입 금액을 입력 받는다.
  - [x] (예외) 입력 값이 양의 정수가 아닌 경우
    ```
    (예시) -1, 0, 2.5, Hi, 5.0000000000000001, 4500000000000000.1
    ```

### 당첨 번호 입력

- [x] 당첨 번호를 입력받는다.

  ```
  당첨 번호를 입력해 주세요.
  1,2,3,4,5,6
  ```

  - [x] 입력 받은 당첨 번호를 쉼표(,)를 기준으로 구분하고, 각 번호의 앞뒤 공백을 제거한다. 각 번호를 `Number`로 캐스팅한다.
- [x] 보너스 번호를 입력받는다.

  ```  
  보너스 번호를 입력해 주세요.
  7
  ```

  - [x] 보너스 번호를 `Number`로 캐스팅한다.

### 로또 출력

- [x] 발행한 로또의 개수를 출력한다.

  ```
  3개를 구매했습니다.
  ```

- [x] 발행한 로또를 차례대로 출력한다.

  ```
  [7, 11, 30, 40, 42, 43]
  [2, 13, 22, 32, 38, 45]
  [1, 3, 5, 14, 22, 45]
  ```

### 당첨 내역 출력

- [x] 당첨 내역을 출력한다.

  ```
  3개 일치 (5,000원) - 1개
  4개 일치 (50,000원) - 0개
  5개 일치 (1,500,000원) - 0개
  5개 일치, 보너스 볼 일치 (30,000,000원) - 0개
  6개 일치 (2,000,000,000원) - 0개
  ```

### 수익률 출력

- [x] 수익률을 출력한다.

  ```
  총 수익률은 62.5%입니다.
  ```

## ✅ 핵심 기능

### 중복되지 않는 랜덤 숫자 추출

- [x] `1~45` 사이 숫자 중 중복되지 않는 `6`개의 숫자를 뽑는다.
  - `@woowacourse/mission-utils`의 `Random.pickUniqueNumbersInRange()`를 사용한다.

    ```javascript
    MissionUtils.Random.pickUniqueNumbersInRange(1, 45, 6);
    ```

### 로또 발행

- [x] `(로또 구입 금액 / 1000)`개 만큼 로또 발행을 반복한다.
  - [x] (예외) 입력 값이 `1000`으로 나누어 떨어지지 않는 경우
- [x] `6`개의 숫자를 번호로 갖는 로또를 발행한다.
  - [x] (예외) 각 번호가 `1~45` 사이의 정수가 아닌 경우

    ```
    (예시) 0, -1, 2.5, 4 2, Hello
    ```

  - [x] (예외) 번호의 총 개수가 `6`개가 아닌 경우
  - [x] (예외) 서로 중복되는 번호가 있는 경우
- [x] 발행한 로또의 번호를 오름차순으로 정렬한다.

### 당첨 로또 발행

- [x] 당첨 로또는 일반 로또와 동일한 구조를 갖는다.
- [x] 추가적으로 보너스 번호 `1`개를 갖는다.
  - [x] (예외) 보너스 번호가 `1~45` 사이의 정수가 아닌 경우

    ```
    (예시) 0, -1, 2.5, 4 2, Hello, '1,2,3'
    ```

  - [x] (예외) 보너스 번호가 당첨 번호와 중복되는 경우

### 당첨 결과 계산

- [x] 로또 번호와 당첨 번호(+보너스 번호)를 비교하여 일치하는 번호의 개수를 센다.
- [x] 아래 기준에 따라 당첨 로또 개수를 센다.

  ```
  당첨 기준 및 당첨 금액
  - 1등: 6개 번호 일치 ⇒ 2,000,000,000원
  - 2등: 5개 번호 + 보너스 번호 일치 ⇒ 30,000,000원
  - 3등: 5개 번호 일치 ⇒ 1,500,000원
  - 4등: 4개 번호 일치 ⇒ 50,000원
  - 5등: 3개 번호 일치 ⇒ 5,000원
  ```

### 수익률 계산

- [x] 수익률을 계산한다. `(수익률 = 당첨 금액의 합 / 로또 구입 금액 * 100)`
- [x] 수익률을 소수점 둘째 자리에서 반올림하여 저장한다.

## 🚨 예외 처리 공통 사항

- 잘못된 값 입력 시, `throw`문을 사용해 예외를 발생시킨다.
  - `"[ERROR]"`로 시작하는 에러 메시지를 출력한다.
  - 에러 메시지 출력 후, ⚠***예외 발생 지점부터 다시 입력 받는다.***

## 👾 실행 결과 예시

```
구입금액을 입력해 주세요.
8000

8개를 구매했습니다.
[8, 21, 23, 41, 42, 43]
[3, 5, 11, 16, 32, 38]
[7, 11, 16, 35, 36, 44]
[1, 8, 11, 31, 41, 42]
[13, 14, 16, 38, 42, 45]
[7, 11, 30, 40, 42, 43]
[2, 13, 22, 32, 38, 45]
[1, 3, 5, 14, 22, 45]

당첨 번호를 입력해 주세요.
1,2,3,4,5,6

보너스 번호를 입력해 주세요.
7

당첨 통계
---
3개 일치 (5,000원) - 1개
4개 일치 (50,000원) - 0개
5개 일치 (1,500,000원) - 0개
5개 일치, 보너스 볼 일치 (30,000,000원) - 0개
6개 일치 (2,000,000,000원) - 0개
총 수익률은 62.5%입니다.
```

---

# 👩‍💻 프로그래밍 요구 사항

### Lotto 클래스

- 제공된 `Lotto` 클래스를 활용해 구현한다.
  - `numbers`의 `#` prefix를 변경할 수 없다.
  - `Lotto`에 필드를 추가할 수 없다.

### 프로그래밍 제약

- indent depth가 3이 넘지 않도록 구현한다.
- 함수의 길이가 15라인을 넘지 않도록 구현한다.
  - 함수가 하나의 역할만 담당하도록 구현한다.
- `else`를 지양한다.
  - 때로는 `if-else`, `switch`가 더 깔끔해 보일 수도 있다.

### 테스트

- Jest를 이용하여 기능 목록이 정상 작동함을 확인한다.
- 도메인 로직에 대한 단위 테스트를 작성한다.
  - 단, UI 로직에 대한 단위 테스트는 제외한다.
  - 핵심 로직 코드와 UI 담당 코드를 구분한다.

### 라이브러리

- Random 값 추출은 `@woowacourse/mission-utils`에서 제공하는 `Random.pickUniqueNumbersInRange()`를 활용한다.
- 입출력은 `@woowacourse/mission-utils`에서 제공하는 `Console.readLineAsync`, `Console.print`를 활용한다.
